==========================================================================================================================================================
An Exploration of Technology Diffusion - Results replication instructions
==========================================================================================================================================================
Version:	      1.0
Date:		      August 12th, 2009
Last modified:	      August 12th, 2009
Contact info:	      Bart Hobijn, Federal Reserve Bank of San Francisco, bart.hobijn@sf.frb.org
----------------------------------------------------------------------------------------------------------------------------------------------------------
Purpose:
This file explains how to replicate the results in the paper "An Exploration of Technology Diffusion" by Diego Comin and Bart Hobijn
----------------------------------------------------------------------------------------------------------------------------------------------------------
Applications needed:
1) Stata (version 9 or higher)                Used for the main calculations.
2) MS Excel (version 2007 or higher)          Used to combine the results into spreadsheet and to consolidate results for charts.
3) An ASCII text editor                       Used to edit the text files that are written by Stata as output
----------------------------------------------------------------------------------------------------------------------------------------------------------
Files needed for the replication:
1) CHExplorationData.dta		      Stata dataset with underlying data in it.
2) Results.dta				      Stata dataset (will be regenerated) with the estimates that are further analyzed.
3) Groups.dta				      Stata dataset with the groups that each of the countries belongs to.
3) EstimateEveryThingTogether.do              Stata DO file that estimates the model for the U.S. and for all other countries.
4) MakeFigureWithExample.do                   Stata DO file that generates the data for the figure with the electricity example (Figure 1).
5) MakeFiguresWithUSFit.do                    Stata DO file that generates the data for the figure with the fit for the U.S. (Figures 2 & 3).
6) MakeFigureWithFit.do                       Stata DO file that generates the figure with the fit for a technology and particular countries (Figure 4).
7) MakeTablesWithResults.do                   Stata DO file that generates the output for the tables in the paper.
8) Results.xlsm				      Excel 2007 Macro-Enabled Workbook that contains all the results.

In addition, you will need the \output subdirectory with all its subdirectories to store the USA-specific and technology-specific results. This directory
structure should be extracted from the ZIP file in the form you need.
----------------------------------------------------------------------------------------------------------------------------------------------------------           

INSTRUCTIONS TO RUN:
====================

a) Change the directory with the location of the files in the DO-files
----------------------------------------------------------------------
In all the DO-files change the line:
local rootpath = "C:\Research\Histtech\progs2\Stata3\"
to the directory that contains the files. For example, if you have extracted the files to C:\CH then change the line to 
local rootpath = "C:\CH\"
Doing this, the programs will know from where to load the datafile and where to write the output files.

b) Calculate the results for all the countries
----------------------------------------------
Run the EstimateEveryThingTogether.do file. This fills the subdirectories of the output subdirectory with the technology-specific output files. It also 
generates an output file called Results**.txt in the output subdirectory, which is a text file with the relevant results to be loaded into Excel and as well
as into the results.dta Stata dataset for further analysis.

c) Run MakeFigureWithExample.do
-------------------------------
This generates figurewithexample.txt in the output directory. Its content can be copied and pasted in the results.xlmx file that 

d) Run MakeFiguresWithUSFit.do
------------------------------
This program generates a log-files called USFIT_** in the FitFigures subdirectory. The actual and fitted time series are used for the plots with the fit for
the U.S. time series. These files are written to the "FitFigures" subdirectory of the output subdirectory.

e) Run MakeFigureWithFit.do
---------------------------
The log-files generated by this program contain the actual and fitted technology adoption time series that are depicted in Figure 4. These files are written to the 
"FitFigures" subdirectory of the output subdirectory.

f) Run MakeTablesWithResults.do
-------------------------------
Generates groups.dta and results.dta.

j) Update the results spreadsheet
---------------------------------
The next step is to copy and paste all the relevant results into the results.xls spreadsheet. Copy and paste the results from the respective log-files to the 
black-tabbed worksheets. After this is done, all tables and figures will be automatically updated. The tables and figures in the paper are directly taken from
the results.xlmx spreadsheet.

 